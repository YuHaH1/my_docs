{"version":3,"file":"Giscus.js","sources":["../../../src/client/components/Giscus.ts"],"sourcesContent":["import { usePageData, usePageLang, withBase } from \"@vuepress/client\";\nimport { type VNode, computed, defineComponent, h, onMounted, ref } from \"vue\";\nimport { LoadingIcon } from \"vuepress-shared/client\";\n\nimport {\n  type GiscusInputPosition,\n  type GiscusMapping,\n  type GiscusRepo,\n  type GiscusTheme,\n} from \"../../shared/index.js\";\nimport { useGiscusOptions } from \"../helpers/index.js\";\n\nimport \"../styles/giscus.scss\";\n\n// Note: Should be updated with https://github.com/giscus/giscus/tree/main/locales\nconst SUPPORTED_LANGUAGES = [\n  \"ar\",\n  \"de\",\n  \"gsw\",\n  \"en\",\n  \"es\",\n  \"fa\",\n  \"fr\",\n  \"id\",\n  \"it\",\n  \"ja\",\n  \"ko\",\n  \"nl\",\n  \"pl\",\n  \"pt\",\n  \"ro\",\n  \"ru\",\n  \"th\",\n  \"tr\",\n  \"uk\",\n  \"vi\",\n  \"zh-CN\",\n  \"zh-TW\",\n] as const;\n\ntype BooleanString = \"0\" | \"1\";\n\nexport type GiscusLang = (typeof SUPPORTED_LANGUAGES)[number];\n\nexport type GiscusLoading = \"lazy\" | \"eager\";\n\nexport interface GiscusProps {\n  id?: string | undefined;\n  repo: GiscusRepo;\n  repoId: string;\n  category?: string | undefined;\n  categoryId?: string | undefined;\n  mapping: GiscusMapping;\n  term?: string | undefined;\n  theme?: GiscusTheme | undefined;\n  reactionsEnabled?: BooleanString | undefined;\n  strict?: BooleanString | undefined;\n  emitMetadata?: BooleanString | undefined;\n  inputPosition?: GiscusInputPosition | undefined;\n  lang?: GiscusLang | undefined;\n  loading?: GiscusLoading | undefined;\n}\n\nexport default defineComponent({\n  name: \"GiscusComment\",\n\n  props: {\n    /**\n     * Whether the component is in darkmode\n     *\n     * 组件是否处于夜间模式\n     */\n    darkmode: Boolean,\n  },\n\n  setup(props) {\n    const giscusOptions = useGiscusOptions();\n    const page = usePageData();\n\n    const enableGiscus = Boolean(\n      giscusOptions.repo &&\n        giscusOptions.repoId &&\n        giscusOptions.category &&\n        giscusOptions.categoryId\n    );\n\n    const { repo, repoId, category, categoryId } = giscusOptions;\n\n    const loaded = ref(false);\n\n    const giscusLang = computed(() => {\n      const lang = usePageLang().value as GiscusLang;\n\n      if (SUPPORTED_LANGUAGES.includes(lang)) return lang;\n\n      const shortCode = lang.split(\"-\")[0] as GiscusLang;\n\n      if (SUPPORTED_LANGUAGES.includes(shortCode)) return shortCode;\n\n      return \"en\";\n    });\n\n    const config = computed(\n      () =>\n        <GiscusProps>{\n          repo,\n          repoId,\n          category,\n          categoryId,\n          lang: giscusLang.value,\n          theme: props.darkmode\n            ? giscusOptions.darkTheme || \"dark\"\n            : giscusOptions.lightTheme || \"light\",\n          mapping: giscusOptions.mapping || \"pathname\",\n          term: withBase(page.value.path),\n          inputPosition: giscusOptions.inputPosition || \"top\",\n          reactionsEnabled:\n            giscusOptions.reactionsEnabled === false ? \"0\" : \"1\",\n          strict: giscusOptions.strict === false ? \"0\" : \"1\",\n          loading: giscusOptions.lazyLoading === false ? \"eager\" : \"lazy\",\n          emitMetadata: \"0\",\n        }\n    );\n\n    onMounted(async () => {\n      await import(/* webpackChunkName: \"giscus\" */ \"giscus\");\n      loaded.value = true;\n    });\n\n    return (): VNode | null =>\n      enableGiscus\n        ? h(\n            \"div\",\n            {\n              class: [\n                \"giscus-wrapper\",\n                { \"input-top\": giscusOptions.inputPosition !== \"bottom\" },\n              ],\n              id: \"comment\",\n            },\n            loaded.value ? h(\"giscus-widget\", config.value) : h(LoadingIcon)\n          )\n        : null;\n  },\n});\n"],"names":["SUPPORTED_LANGUAGES","Giscus","defineComponent","props","giscusOptions","useGiscusOptions","page","usePageData","enableGiscus","repo","repoId","category","categoryId","loaded","ref","giscusLang","computed","lang","usePageLang","shortCode","config","withBase","onMounted","h","LoadingIcon"],"mappings":"+RAeA,MAAMA,EAAsB,CAC1B,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,QACA,OACF,EAyBA,IAAAC,EAAeC,EAAgB,CAC7B,KAAM,gBAEN,MAAO,CAML,SAAU,OACZ,EAEA,MAAMC,EAAO,CACX,MAAMC,EAAgBC,IAChBC,EAAOC,IAEPC,EAAe,CACnBJ,EAAAA,EAAc,MACZA,EAAc,QACdA,EAAc,UACdA,EAAc,YAGZ,CAAE,KAAAK,EAAM,OAAAC,EAAQ,SAAAC,EAAU,WAAAC,CAAW,EAAIR,EAEzCS,EAASC,EAAI,EAAK,EAElBC,EAAaC,EAAS,IAAM,CAChC,MAAMC,EAAOC,EAAY,EAAE,MAE3B,GAAIlB,EAAoB,SAASiB,CAAI,EAAG,OAAOA,EAE/C,MAAME,EAAYF,EAAK,MAAM,GAAG,EAAE,CAAC,EAEnC,OAAIjB,EAAoB,SAASmB,CAAS,EAAUA,EAE7C,IACT,CAAC,EAEKC,EAASJ,EACb,KACe,CACX,KAAAP,EACA,OAAAC,EACA,SAAAC,EACA,WAAAC,EACA,KAAMG,EAAW,MACjB,MAAOZ,EAAM,SACTC,EAAc,WAAa,OAC3BA,EAAc,YAAc,QAChC,QAASA,EAAc,SAAW,WAClC,KAAMiB,EAASf,EAAK,MAAM,IAAI,EAC9B,cAAeF,EAAc,eAAiB,MAC9C,iBACEA,EAAc,mBAAqB,GAAQ,IAAM,IACnD,OAAQA,EAAc,SAAW,GAAQ,IAAM,IAC/C,QAASA,EAAc,cAAgB,GAAQ,QAAU,OACzD,aAAc,GAChB,EACJ,EAEA,OAAAkB,EAAU,SAAY,CACpB,KAA8C,QAAA,QAAQ,EACtDT,EAAO,MAAQ,EACjB,CAAC,EAEM,IACLL,EACIe,EACE,MACA,CACE,MAAO,CACL,iBACA,CAAE,YAAanB,EAAc,gBAAkB,QAAS,CAC1D,EACA,GAAI,SACN,EACAS,EAAO,MAAQU,EAAE,gBAAiBH,EAAO,KAAK,EAAIG,EAAEC,CAAW,CACjE,EACA,IACR,CACF,CAAC"}